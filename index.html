<!doctype html>

</html>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Desk Selector</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css">
  <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="./css/header.css">
  <link rel="stylesheet" href="./css/booking-info.css">
  <link rel="stylesheet" href="./css/map.css">
  <link rel="stylesheet" href="./css/booking.css">
  <link rel="stylesheet" href="./css/tooltip.css">
</head>

<body>
  <header
    class="container-fluid d-flex flex-wrap align-items-center justify-content-center justify-content-md-between py-3 mb-4-bottom">

      <div class="row">
        <a class="navbar-brand col col-1 offset-2" href="#" id="logo">
          <img src="logo.svg" alt="" class="img-fluid">
        </a>
        <ul class="col-8 justify-content-end flex">
          <li class="nav-item active"><button>Office</button></li>
          <li class="nav-item active"><button>My bookings</button></li>
          <li class="nav-item"><button>Statistics</button>
          </li>
        </ul>
        <div class="col col-1">
          <button class="account"><i class="fa-solid fa-circle-user"></i></button>
        </div>
      </div>
  </header>
  <div class="tooltip">
    <p><strong>Section Name</strong></h2>
    <p>Vacant: <span id="vacant">7</span>/<span class="max">14</span></p>
    <p>Partially Booked: <span id="partial">2</span>/<span class="max">14</span></p>
  </div>
  <aside id="booking-info" style="display: none;">
    <form class="container">
      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="exampleCheck1" checked>
        <label class="form-check-label" for="exampleCheck1">Morning</label>
      </div>
      <div class="form-check">
        <input type="checkbox" class="form-check-input" id="exampleCheck1" checked>
        <label class="form-check-label" for="exampleCheck1">Afternoon</label>
      </div>
      <button type="button" class="btn btn-primary" id="book">Book</button>
    </form>
  </aside>

  <div class="container hide" id="booking">
      <div class="row">
        <div class="col col-3">
          <input type="date" id="dateId" class="form-control" required />
        </div>
        <h2 class="col col-6 text-center">UDI Zone</h2>
      </div>
      <div class="container" id="desks">
        <div clas="container-fluid">
          <div class="row">
            <div class="col-4" data-status="">
              <button type="button" data-desk="0" data-status="" class="btn btn-lg custom-btn"></button>
            </div>
            <div class="col-4" data-status="">
              <button data-desk="1" data-status="" type="button" class="btn btn-lg custom-btn"><i
                  class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="col-4" data-status="">
              <button data-desk="2" data-status="" type="button" class="btn btn-lg custom-btn"></button>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-4">
              <button data-desk="3" data-status="" type="button" class="btn btn-lg custom-btn"></button>
            </div>
            <div class="col-4">
              <button data-desk="4" data-status="" type="button" class="btn btn-lg custom-btn">

              </button>
            </div>
            <div class="col-4">
              <button data-desk="5" data-status="" type="button" class="btn btn-lg custom-btn"></button>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-4 offset-2">
              <button data-desk="6" data-status="" type="button" class="btn btn-lg custom-btn"></button>
            </div>
            <div class="col-4">
              <button data-desk="7" data-status="" type="button" class="btn btn-lg custom-btn"></button>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-4 offset-2">
              <button data-desk="8" data-status="" type="button" class="btn btn-lg custom-btn"></button>
            </div>
            <div class="col-4">
              <button data-desk="9" data-status="" type="button" class="btn btn-lg custom-btn"></button>
            </div>
          </div>
          <div class="row mt-3">
            <div class="col-4">
              <button data-desk="10" data-status="" type="button" class="btn btn-lg custom-btn"></button>
            </div>
            <div class="col-4">
              <button data-desk="11" data-status="" type="button" class="btn btn-lg custom-btn"><i
                  class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="col-4">
              <button data-desk="12" data-status="" type="button" class="btn btn-lg custom-btn"></button>
            </div>
          </div>
          <div class="row mt-2">
            <div class="col-4">
              <button data-desk="13" data-status="" type="button" class="btn btn-lg custom-btn"></button>
            </div>
            <div class="col-4">
              <button data-desk="14" data-status="" type="button" class="btn btn-lg custom-btn"><i
                  class="fa-solid fa-xmark"></i></button>
            </div>
            <div class="col-4">
              <button data-desk="15" data-status="" type="button" class="btn btn-lg custom-btn"></button>
            </div>
          </div>
        </div>
      </div>
  </div>
  <section id="map" class="container">
    <div class="row title">
      <div class="col col-3">
        <input type="date" id="dateId-main" class="form-control" required />
      </div>
      <h2 class="text-center col col-6">Digital Hub</h2>
      <div class="col col-3">
        <select name="" class="form-select" id="">
          <option value="vacant">Vacancy</option>
          <option value="predict">Prediction</option>
        </select>
      </div>
    </div>
    <figure>
      <div class="grid">
        <div class="top-section">
          <button class="btn" data-zone-id="0"></button>
          <button class="btn" data-zone-id="1"></button>
          <button class="btn" data-zone-id="2"></button>
        </div>
        <div class="left-section">
          <button class="btn" data-zone-id="3"></button>
          <button class="btn" data-zone-id="4"></button>
        </div>
        <div class="bottom-section">
          <button class="btn" data-zone-id="5"></button>
          <button class="btn" data-zone-id="6"></button>
          <button class="btn" data-zone-id="7"></button>
        </div>
      </div>
      <img src="./img/map.svg" class="img-fluid" />
    </figure>
    <div class="subtitle hide" id="subtitle">
      <ul>
        <li><span class="success"><i class="fa-solid fa-mug-hot"></i></span>Bring your friends!</li>
        <li><span class="warning"><i class="fa-solid fa-head-side-mask"></i></span>You will not be alone</li>
        <li><span class="danger"><i class="fa-solid fa-poo-storm"></i></span>Ready to fight?</li>
      </ul>
    </div>
  </section>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.min.js"></script>
  <script>

    let zones = [
      {
        id: 0,
        name: "Digital Operations & E-Commerce I",
        seats: 16,
        available: 15,
        partial: 4
      },
      {
        id: 1,
        name: "Digital Operations & E-Commerce/Shopping",
        seats: 16,
        available: 3,
        partial: 4
      },
      {
        id: 2,
        name: "Shopping",
        seats: 16,
        available: 3,
        partial: 4
      },
      {
        id: 12,
        name: "Deliver on Promise",
        seats: 16,
        available: 3,
        partial: 4
      },
      {
        id: 4,
        name: "Digital Technology and Strategy",
        seats: 16,
        available: 3,
        partial: 4
      },
      {
        id: 5,
        name: "Data Analytics and Center of Excelence",
        seats: 16,
        available: 3,
        partial: 4
      },
      {
        id: 6,
        name: "UDI Zone",
        seats: 16,
        available: 8,
        partial: 1
      },
      {
        id: 7,
        name: "Data Analytics and Center of Excelence II",
        seats: 16,
        available: 3,
        partial: 4
      }
    ]
    let bookedDesks = []
    let selectedDesks = []
    let seatVacancy = [0, 0, 1, 0, 0, 2, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1]
    let select = document.querySelector("select")

    let mapButtons = document.querySelectorAll("#map button");
    let logo = document.querySelector("#logo");
    var bookingInfoForm = document.getElementById("booking-info");
    const mapSection = document.querySelector("#map");
    const bookingSection = document.querySelector("#booking");
    const tooltip = document.querySelector(".tooltip")

    mapButtons.forEach(button => {
      button.addEventListener("click", (e) => {
        mapSection.classList.add("hide");
        bookingSection.classList.remove("hide");
        bookingInfoForm.style.display = "block";
      });
    });

    mapButtons.forEach(button => {
      let buttonIndex = button.getAttribute("data-zone-id")
      let status = "";
      let icon = ""
      if(zones[buttonIndex].available <= zones[buttonIndex].seats/4){
        status = "danger"
        icon = "poo-storm"
      } else if(zones[buttonIndex].available <= zones[buttonIndex].seats/2){
        status = "warning"
        icon = "head-side-mask"
      } else {
        status = "success"
        icon = "mug-hot"
      }
      button.classList.add(status)
      button.innerHTML = "<i class='fa-solid fa-" + icon + "'></i>"
      button.addEventListener("mouseover", (e) => {
        let buttonPos = e.target.getBoundingClientRect()
        let zoneTitle = document.querySelector(".tooltip p:first-of-type strong");
        let availableSeats = document.querySelector("#vacant");
        let maxSeats = document.querySelectorAll(".tooltip .max");
        let partial = document.querySelector("#partial");
        let id = e.target.getAttribute("data-zone-id")

        tooltip.style.top = buttonPos.top + "px";
        tooltip.style.left = (buttonPos.left + 50) + "px";
        zoneTitle.innerHTML = zones[id].name
        availableSeats.innerHTML = zones[id].available
        partial.innerHTML = zones[id].partial
        maxSeats.forEach(span => {
          span.innerHTML = zones[id].seats
        })
        tooltip.classList.add("show")
      });

      button.addEventListener("mouseleave", (e) => {
        tooltip.classList.remove("show")
        let buttonPos = e.target.getBoundingClientRect()
        tooltip.style.top = "0px";
        tooltip.style.left = "0px";
      });
    });

    select.addEventListener("change", (e) => {
      if(e.target.value == "vacant") {
        document.querySelector("#subtitle").classList.add("hide")
        document.querySelectorAll(".predict").forEach(button => {
          button.classList.remove("predict");
        })
      } else {
        document.querySelector("#subtitle").classList.remove("hide")
        document.querySelectorAll(".grid button").forEach(button => {
          button.classList.add("predict")
        })
      }
    })

    logo.addEventListener("click", (e) => {
      mapSection.classList.remove("hide");
      bookingSection.classList.add("hide");
      bookingInfoForm.style.display = "none";
    });


    var date = new Date();
    var day = date.getDate();
    var month = date.getMonth() + 1;
    var year = date.getFullYear();

    if (month < 10) month = "0" + month;
    if (day < 10) day = "0" + day;

    var today = year + "-" + month + "-" + day;

    document.getElementById("dateId").value = today;
    document.getElementById("dateId-main").value = today;

  </script>
  <script src="./js/booking.js"></script>
</body>

</html>